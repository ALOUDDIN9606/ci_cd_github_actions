<!DOCTYPE html>
<html lang="en">
  <%- include("./partials/head.ejs") %>
  <body>
    <%- include("./partials/nav.ejs") %>

    <div class="box-4">
      <h2><%=user.name %></h2>
      <p class="name-li">User name: <%=user.username %></p>
      <p class="name-li">Email: <%=user.email %></p>
      <p class="name-li">Phone: <%=user.phone %></p>
      <p class="name-li">Website: <%=user.website %></p>
      <p class="name-li">Address: <%=user?.address?.city %></p>

      <a class="name-a" href="/edit/<%=user.id %>">Tahrirlash</a>
      <button class="name-btn" data-id=" <%=user.id %> " id="del">
        O'chirish
      </button>
    </div>

    <script>
      const delBtn = document.getElementById("del");
      delBtn.addEventListener("click", (e) => {
        const id = e.target?.dataset?.id || null;
        if (id) {
          fetch(`/user/${id}`, {
            method: "DELETE",
          }).then(() => {
            console.log("User deleted.");
            alert("User Deleted.");
            setTimeout(() => {
              window.location.href = "/users";
            }, 200);
          });
        }
      });
    </script>
  </body>
</html>
